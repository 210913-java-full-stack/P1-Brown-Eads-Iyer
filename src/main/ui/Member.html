<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <![endif]-->
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/layout.css" type="text/css" media="all">
    <link rel="stylesheet" href="css/style.css" type="text/css" media="all">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Member-Menu</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="">
</head>

<body>
<div class="main">
    <div class="header"></div>
    <div id="banner"><br>
        <h1>Dream Airlines</h1>
        <h2>Come Fly With Us</h2>
    </div>
</div>

<div class="row">
    <div class="column0"></div>
    <div class="column1">
        <img src="pics/Plane_Body_200.png" alt="Plane Body">
    </div>
    <div class="column2">
        <br>
        <h3>Check in for your flight.</h3>
        <p>Let us know your here! Just give us the ticket number and we'll do
            our best to hold the flight a little longer. Please don't delay
            too long though, we can't hold on forever.</p>
        <form id="checkin-form">
            <h5>Ticket Number: </h5>
            <input type="text" name="ticket" id="checkinField" class="checkin-form-field">
            <br><br>
            <a id = "checkButt" class="button">Check In</a>
            <br><br>
        </form>
        <br>
        <h3>Need to Cancel?</h3>
        <p>We're sorry to hear that. To cancel put in your ticket <br>
            number in just like you were going to check in, and <br>then
            click the 'Cancel' button.</p>
        <form id="cancel-form">
            <h5>Ticket Number: </h5>
            <input type="text" name="ticket" id="cancelField" class="cancel-form-field">
            <br><br>
            <!--input type="submit" value="Check-In" id="checkin-form-submit"-->
            <a id = "cancelButt" class="button">Cancel</a>
            <br><br>
        </form>
    </div>

    <div class="column3">
        <img src="pics/Take-Off.gif" alt="Take Off">
        <br><br>
        <br>
        <h4>To purchase more tickets please click below.</h4>
        <a href = "Flight.html" id = "toFlightButt" class="button">Buy Tickets</a>
    </div>
    <div class="column0"></div>
</div>
<script src="" async defer></script>


<script>
    var form = document.getElementById("checkin-form");
    checkButt.addEventListener("click", function(event) {
    event.preventDefault();
    console.log(checkinField.value);
    marshall1(checkinField.value);
    });

    var form = document.getElementById("cancel-form");
    cancelButt.addEventListener("click", function(event) {
    event.preventDefault();
    console.log(cancelField.value);
    marshall1(cancelField.value);
    });

    async function marshall1(checkTik){
        let checkTicket = {
            ticket_num : checkTik,
            check_in : true
        }

        let response = await fetch("http://localhost:8080/P1-Brown-Eads-Iyer/booking", {
            method: "POST",
<!--            headers: {"Content-Type":application/json"},-->
            body: JSON.stringify(checkTicket)
        });

        if(response.status != 202){
            document.getElementById("checkin-form").reset();
            alert("Check In Failed");
        }
        else{
            window.location.href = "Member.html";
        }

    async function marshall2(cancelTik){
        let ticket = {
            ticket_num : cancelTik,
        }

        let response = await fetch("http://localhost:8080/P1-Brown-Eads-Iyer/booking", {
            method: "POST",
<!--            headers: {"Content-Type":application/json"},-->
            body: JSON.stringify(ticket)
        });

        if(response.status = 401){
            document.getElementById("cancel-form").reset();
            alert("Ticket Cancellation Failed");
        }
        else{
            window.location.href = "Member.html";
        }
        }
        }
</script>

</body>

</html>
